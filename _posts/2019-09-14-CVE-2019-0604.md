---
title: SharePoint CVE-2019-0604 RCE Detection
date: 2019-09-14
tags: [CVE, Detetction, Web, Exploit]
categories: [Exploit, Detetction]
render_with_liquid: true
---

## Introduction

I decided to write this post as I did not notice any significant detection methods published publicly. In this post, a quick PoC will be demonstrated and analysis of the generated logs by the exploit will be discussed to provide detection methods for the initial stages of the attack.

If you want to read more about the exploit and how it works, I advise to read the below articles:

* [https://www.zerodayinitiative.com/blog/2019/3/13/cve-2019-0604-details-of-a-microsoft-sharepoint-rce-vulnerability](https://www.zerodayinitiative.com/blog/2019/3/13/cve-2019-0604-details-of-a-microsoft-sharepoint-rce-vulnerabilityhttps:/)
* [https://www.zerodayinitiative.com/blog/2019/3/13/cve-2019-0604-details-of-a-microsoft-sharepoint-rce-vulnerability](https://www.zerodayinitiative.com/blog/2019/3/13/cve-2019-0604-details-of-a-microsoft-sharepoint-rce-vulnerability)

## PoC Demonstration


{% include embed/video.html src='assets/vid/20190914/poc.mp4' types=mp4 title='Text' %}
> In the above video you will see the exploit and executing remote command creating new process towards target server by sending a crafted HTTP POST request with particular URL path and payload parameter and value.
{: .prompt-info }

## Network Analysis And Detection 

As shown in the PoC video, the exploit is done through sending a crafted HTTP POST request to SharePoint web app. The following picture details the request structure.
![Desktop View](assets/img/20190914/1.png)
_Exploit packet capture _


